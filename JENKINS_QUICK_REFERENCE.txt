# Jenkins CI/CD Integration Guide

## Quick Reference for Jenkins with Test Automation

---

## üöÄ Installation Quick Start

### Windows
```bash
# Download from https://www.jenkins.io/download/
# Run installer
# Access at http://localhost:8080

# Or with Java:
java -jar jenkins.war
```

### Linux (Ubuntu/Debian)
```bash
wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo apt-key add -
sudo sh -c 'echo deb https://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'
sudo apt-get update
sudo apt-get install jenkins
sudo systemctl start jenkins
```

### macOS
```bash
brew install jenkins
brew services start jenkins
```

---

## üìã Essential Jenkins Plugins

```
1. Blue Ocean - Beautiful pipeline visualization
2. Pipeline - Jenkins Pipeline support
3. Git - Git repository support
4. Python - Python execution support
5. Robot Framework - Robot Framework integration
6. Email - Email notifications
7. Docker - Docker integration
8. GitHub - GitHub integration
```

---

## üîß Quick Pipeline Template

```groovy
pipeline {
    agent any
    
    triggers {
        githubPush()
        cron('H 2 * * *')  // Daily at 2 AM
    }
    
    options {
        timestamps()
        timeout(time: 1, unit: 'HOURS')
    }
    
    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }
        
        stage('Setup') {
            steps {
                sh '''
                    python -m venv venv
                    . venv/bin/activate
                    pip install -r requirements.txt
                '''
            }
        }
        
        stage('Test') {
            parallel {
                stage('Unit Tests') {
                    steps {
                        sh '. venv/bin/activate && pytest tests/unit --junitxml=unit.xml'
                    }
                }
                stage('Selenium Tests') {
                    steps {
                        sh '. venv/bin/activate && pytest tests/selenium --junitxml=selenium.xml'
                    }
                }
                stage('API Tests') {
                    steps {
                        sh '. venv/bin/activate && pytest tests/api --junitxml=api.xml'
                    }
                }
            }
        }
    }
    
    post {
        always {
            junit '*.xml'
            cleanWs()
        }
    }
}
```

---

## üêç Running Python Tests

### Basic Setup
```groovy
stage('Run Tests') {
    steps {
        sh '''
            python -m venv venv
            . venv/bin/activate
            pip install pytest selenium requests robotframework
            pytest tests/ -v --junitxml=results.xml
        '''
    }
}
```

### With Coverage Report
```groovy
stage('Tests with Coverage') {
    steps {
        sh '''
            . venv/bin/activate
            pip install pytest-cov pytest-html
            pytest tests/ 
                --cov=src 
                --cov-report=html 
                --html=report.html 
                --junitxml=results.xml
        '''
    }
    post {
        always {
            publishHTML([
                reportDir: 'htmlcov',
                reportFiles: 'index.html',
                reportName: 'Code Coverage'
            ])
        }
    }
}
```

---

## üåê Selenium Tests in Jenkins

```groovy
pipeline {
    agent any
    
    environment {
        CHROME_BIN = '/usr/bin/google-chrome'
        DISPLAY = ':99'
    }
    
    stages {
        stage('Setup Chrome') {
            steps {
                sh 'sudo apt-get update && sudo apt-get install -y chromium-browser'
            }
        }
        
        stage('Run Selenium Tests') {
            steps {
                sh '''
                    . venv/bin/activate
                    pytest tests/selenium/ 
                        -v 
                        --headless 
                        --junitxml=selenium-results.xml
                '''
            }
        }
    }
    
    post {
        always {
            junit 'selenium-results.xml'
            archiveArtifacts artifacts: 'screenshots/**', allowEmptyArchive: true
        }
    }
}
```

---

## ü§ñ Robot Framework in Jenkins

```groovy
stage('Run Robot Tests') {
    steps {
        sh '''
            pip install robotframework robotframework-seleniumlibrary
            robot --outputdir results/
                --log NONE 
                --report NONE 
                --xunit results/robot.xml 
                tests/
        '''
    }
    post {
        always {
            robot outputPath: 'results',
                   logFileName: 'log.html',
                   reportFileName: 'report.html'
        }
    }
}
```

---

## üì° API Tests in Jenkins

```groovy
stage('API Tests') {
    steps {
        sh '''
            . venv/bin/activate
            pip install requests pytest pytest-json-report
            
            export API_URL=https://api.example.com
            export API_KEY=${CREDENTIALS_API_KEY}
            
            pytest tests/api/
                -v 
                --junitxml=api-results.xml 
                --html=api-report.html 
                --self-contained-html
        '''
    }
}
```

---

## üîÑ GitHub Integration

### Webhook Trigger
1. Go to GitHub repository settings
2. Add webhook: `http://jenkins-server:8080/github-webhook/`
3. Content type: `application/json`
4. Trigger on `push` events

### Pipeline Configuration
```groovy
pipeline {
    agent any
    
    triggers {
        githubPush()
    }
    
    post {
        failure {
            step([$class: 'GitHubIssueNotifier'])
        }
    }
}
```

---

## üê≥ Docker Integration

```groovy
pipeline {
    agent any
    
    environment {
        DOCKER_IMAGE = 'test-automation:${BUILD_NUMBER}'
    }
    
    stages {
        stage('Build Docker Image') {
            steps {
                sh 'docker build -t ${DOCKER_IMAGE} .'
            }
        }
        
        stage('Run Tests in Docker') {
            steps {
                sh '''
                    docker run --rm 
                        -v ${WORKSPACE}/results:/app/results 
                        ${DOCKER_IMAGE} 
                        pytest tests/ -v --junitxml=results/test-results.xml
                '''
            }
        }
    }
    
    post {
        always {
            sh 'docker rmi ${DOCKER_IMAGE}'
            junit 'results/test-results.xml'
        }
    }
}
```

### Dockerfile Example
```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

CMD ["pytest", "tests/", "-v", "--junitxml=results/test-results.xml"]
```

---

## üìä Test Reporting

### Publish Test Results
```groovy
post {
    always {
        junit testResults: '**/results/**/*.xml', allowEmptyResults: true
        
        publishHTML([
            reportDir: 'htmlcov',
            reportFiles: 'index.html',
            reportName: 'Coverage Report'
        ])
    }
}
```

### Archive Artifacts
```groovy
post {
    always {
        archiveArtifacts artifacts: 'reports/**,screenshots/**', 
                         allowEmptyArchive: true
    }
}
```

---

## üìß Notifications

### Email Notifications
```groovy
post {
    failure {
        emailext(
            subject: "Build Failed: ${env.JOB_NAME} #${env.BUILD_NUMBER}",
            body: "Tests failed. Check logs: ${env.BUILD_URL}",
            to: 'team@example.com',
            attachmentsPattern: '*.xml'
        )
    }
    success {
        emailext(
            subject: "Build Success: ${env.JOB_NAME}",
            body: "All tests passed!",
            to: 'team@example.com'
        )
    }
}
```

### Slack Notifications
```groovy
post {
    failure {
        slackSend(
            channel: '#qa-tests',
            color: 'danger',
            message: "Test failed: ${env.JOB_NAME} #${env.BUILD_NUMBER}"
        )
    }
}
```

---

## üîê Security & Credentials

### Store Credentials
1. Jenkins Dashboard ‚Üí Manage Jenkins ‚Üí Manage Credentials
2. Add credentials (API keys, passwords, tokens)
3. Use in pipeline with `credentials()` function

### Using Credentials
```groovy
environment {
    API_KEY = credentials('api-key-credential-id')
    DB_PASSWORD = credentials('db-password-credential-id')
}

stage('Run Tests') {
    steps {
        sh 'export API_KEY=${API_KEY} && pytest tests/'
    }
}
```

---

## ‚öôÔ∏è Performance Optimization

### Parallel Execution
```groovy
stage('Tests') {
    parallel {
        stage('Unit Tests') {
            steps {
                sh 'pytest tests/unit -n auto'
            }
        }
        stage('Integration Tests') {
            steps {
                sh 'pytest tests/integration -n auto'
            }
        }
        stage('UI Tests') {
            steps {
                sh 'pytest tests/ui -n auto'
            }
        }
    }
}
```

### Run Tests on Multiple Browsers
```groovy
stage('Selenium Tests') {
    parallel {
        stage('Chrome') {
            steps {
                sh 'pytest tests/selenium -m chrome --junitxml=chrome.xml'
            }
        }
        stage('Firefox') {
            steps {
                sh 'pytest tests/selenium -m firefox --junitxml=firefox.xml'
            }
        }
        stage('Safari') {
            steps {
                sh 'pytest tests/selenium -m safari --junitxml=safari.xml'
            }
        }
    }
}
```

---

## üõ†Ô∏è Troubleshooting

### Common Issues

**Build Timeout**
```groovy
options {
    timeout(time: 2, unit: 'HOURS')
}
```

**Out of Memory**
```groovy
environment {
    JAVA_OPTS = '-Xmx2G'
}
```

**Flaky Tests - Add Retry**
```groovy
stage('Run Tests') {
    steps {
        retry(3) {
            sh 'pytest tests/'
        }
    }
}
```

**Clean Workspace**
```groovy
post {
    always {
        cleanWs()
    }
}
```

---

## üìö Quick Links

- [Jenkins Official Documentation](https://www.jenkins.io/doc/)
- [Jenkins Pipeline Documentation](https://www.jenkins.io/doc/book/pipeline/)
- [Jenkins Plugin Directory](https://plugins.jenkins.io/)
- [Blue Ocean (Pipeline Visualization)](https://www.jenkins.io/doc/book/blueocean/)

---

## ‚úÖ Best Practices Checklist

- ‚úÖ Use Jenkinsfile in Git repository
- ‚úÖ Store secrets in Jenkins credentials, not in code
- ‚úÖ Use Docker for consistent test environments
- ‚úÖ Run tests in parallel for speed
- ‚úÖ Set appropriate timeouts
- ‚úÖ Clean up workspace after tests
- ‚úÖ Archive test results and artifacts
- ‚úÖ Send notifications on failure
- ‚úÖ Monitor build trends and metrics
- ‚úÖ Regularly update Jenkins and plugins

---

**Jenkins CI/CD is the backbone of modern automated testing!**
